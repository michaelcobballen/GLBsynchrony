Lips: spatial smoothing of cancer rates

The  rates of lip cancer in 56 counties in Scotland have been analysed by Clayton and Kaldor (1987) and 
Breslow and Clayton (1993).  The form of the data includes the observed and expected cases (expected
numbers based on the population and its age and sex distribution in the county), a covariate measuring
the percentage of the population engaged in agriculture, fishing, or forestry, and the "position'' of each 
county expressed as a list of adjacent counties.


	County		Observed	Expected	x	SMR	Adjacent
			cases	cases	(% in agric.)		counties
	_________________________________________________________________		
 	1		9	1.4	16	652.2	5,9,11,19
	2		39	8.7	16	450.3	7,10
 	...		...	...	...	...	...		
	56		0	1.8	10	0.0	18,24,30,33,45,55


We note that the extreme SMRs (Standardised Mortality Ratios) are based on very few cases. Breslow 
and Clayton initially consider a random-effects Poisson model allowing for over-dispersion, where   
Oi,Ei are the observed and expected cancer incidence in the ith county.  

model
{
   for (i in 1 : regions) {
      O[i] ~ dpois(mu[i])
      log(mu[i]) <- log(E[i]) + beta0 + beta1*aff[i]/10 + phi[i] + theta[i]
      theta[i] ~ dnorm(0.0,tau.h)
      xi[i] <- theta[i] + phi[i]
      SMRhat[i] <- 100 * mu[i] / E[i]
      SMRraw[i] <- 100* O[i] / E[i]
   }
   phi[1:regions] ~ car.normal(adj[], weights[], num[], tau.c)

   beta0 ~ dnorm(0.0, 1.0E-5)  # vague prior on grand intercept
   beta1 ~ dnorm(0.0, 1.0E-5)  # vague prior on covariate effect

   tau.h ~ dgamma(1.0E-3,1.0E-3)  #  ``fair'' prior from Best et al.
   tau.c ~ dgamma(1.0E-1,1.0E-1)  #   (1999, Bayesian Statistics 6)

   sd.h <- sd(theta[]) # marginal SD of heterogeneity effects
   sd.c <- sd(phi[])   # marginal SD of clustering (spatial) effects

   alpha <- sd.c / (sd.h + sd.c)
}
			
Data  list(regions = 56,  
 	O   = c(    9,   39,   11,    9,   15,    8,   26,    7,    6,   20,
                13,    5,    3,    8,   17,    9,    2,    7,    9,    7,
                16,   31,   11,    7,   19,   15,    7,   10,   16,   11,
                 5,    3,    7,    8,   11,    9,   11,    8,    6,    4,
                10,    8,    2,    6,   19,    3,    2,    3,   28,    6,
                 1,    1,    1,    1,    0,    0),
     E = c( 1.4, 8.7, 3.0, 2.5, 4.3, 2.4, 8.1, 2.3, 2.0, 6.6,
            4.4, 1.8, 1.1, 3.3, 7.8, 4.6, 1.1, 4.2, 5.5, 4.4,
           10.5,22.7, 8.8, 5.6,15.5,12.5, 6.0, 9.0,14.4,10.2,
            4.8, 2.9, 7.0, 8.5,12.3,10.1,12.7, 9.4, 7.2, 5.3,
           18.8,15.8, 4.3,14.6,50.7, 8.2, 5.6, 9.3,88.7,19.6,
            3.4, 3.6, 5.7, 7.0, 4.2, 1.8), 
      aff = c(16,16,10,24,10,24,10, 7, 7,16, 
              7,16,10,24, 7,16,10, 7, 7,10,
              7,16,10, 7, 1, 1, 7, 7,10,10,
              7,24,10, 7, 7, 0,10, 1,16, 0,
              1,16,16, 0, 1, 7, 1, 1, 0, 1,
              1, 0, 1, 1,16,10),
     adj = c( 5, 9,11,19,
              7,10,
              6,12,
             18,20,28,
              1,11,12,13,19,
              3, 8,
              2,10,13,16,17,
              6,
              1,11,17,19,23,29,
              2, 7,16,22,
              1, 5, 9,12,
              3, 5,11,
              5, 7,17,19,
             31,32,35,
             25,29,50,
              7,10,17,21,22,29,
              7, 9,13,16,19,29,
              4,20,28,33,55,56,
              1, 5, 9,13,17,
              4,18,55,
             16,29,50,
             10,16,
              9,29,34,36,37,39,
             27,30,31,44,47,48,55,56,
             15,26,29,
             25,29,42,43,
             24,31,32,55,
              4,18,33,45,
              9,15,16,17,21,23,25,26,34,43,50,
             24,38,42,44,45,56,
             14,24,27,32,35,46,47,
             14,27,31,35,
             18,28,45,56,
             23,29,39,40,42,43,51,52,54,
             14,31,32,37,46,
             23,37,39,41,
             23,35,36,41,46,
             30,42,44,49,51,54,
             23,34,36,40,41,
             34,39,41,49,52,
             36,37,39,40,46,49,53,
             26,30,34,38,43,51,
             26,29,34,42,
             24,30,38,48,49,
             28,30,33,56,
             31,35,37,41,47,53,
             24,31,46,48,49,53,
             24,44,47,49,
             38,40,41,44,47,48,52,53,54,
             15,21,29,
             34,38,42,54,
             34,40,49,54,
             41,46,47,49,
             34,38,49,51,52,
             18,20,24,27,56,
             18,24,30,33,45,55),
		weights = c( 1, 1,1,1,
              1,1,
              1,1,
             1,1,1,
              1,1,1,1,1,
              1, 1,
              1,1,1,1,1,
              1,
              1,1,1,1,1,1,
              1, 1,1,1,
              1, 1, 1,1,
              1, 1,1,
              1, 1,1,1,
             1,1,1,
             1,1,1,
              1,1,1,1,1,1,
              1, 1,1,1,1,1,
              1,1,1,1,1,1,
              1, 1, 1,1,1,
              1,1,1,
             1,1,1,
             1,1,
              1,1,1,1,1,1,
             1,1,1,1,1,1,1,1,
             1,1,1,
             1,1,1,1,
             1,1,1,1,
              1,1,1,1,
              1,1,1,1,1,1,1,1,1,1,1,
             1,1,1,1,1,1,
             1,1,1,1,1,1,1,
             1,1,1,1,
             1,1,1,1,
             1,1,1,1,1,1,1,1,1,
             1,1,1,1,1,
             1,1,1,1,
             1,1,1,1,1,
             1,1,1,1,1,1,
             1,1,1,1,1,
             1,1,1,1,1,
             1,1,1,1,1,1,1,
             1,1,1,1,1,1,
             1,1,1,1,
             1,1,1,1,1,
             1,1,1,1,
             1,1,1,1,1,1,
             1,1,1,1,1,1,
             1,1,1,1,
             1,1,1,1,1,1,1,1,1,
             1,1,1,
             1,1,1,1,
             1,1,1,1,
             1,1,1,1,
             1,1,1,1,1,
             1,1,1,1,1,
             1,1,1,1,1,1),
num = c(4, 2, 2, 3, 5, 2, 5, 1,  6, 
            4, 4, 3, 4, 3, 3, 6, 6, 6 ,5, 
            3, 3, 2, 6, 8, 3, 4, 4, 4,11,  
            6, 7, 4, 4, 9, 5, 4, 5, 6, 5, 
            5, 7, 6, 4, 5, 4, 6, 6, 4, 9, 
            3, 4, 4, 4, 5, 5, 6)
     )


Inits  

list(tau.h = 1, tau.c = 1, beta0 = 0, beta1 = 0, 
theta=c(0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0),
phi=c(0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0))




