library(R2WinBUGS)
library(sp)
library(maptools)
library(maps)
library(spdep)

### setting up required variables in BUGS format to pass to R2WinBUGS package
# note: need to run code in bbs_to_geobugs_format.R first

count = route.year.grid$count
strat = route.year.grid$strat
obser = as.numeric(gsub("\\.","",route.year.grid$obser))
firstyr = route.year.grid$firstyr
year = route.year.grid$year

ncounts = c(nrow(route.year.grid))
nstrata = nrow(grid.grsp.lamb0@data)
ymin = 1
ymax = 2017-1965
nonzeroweight = grid.grsp.lamb0@data$nonzeroweight
strata = grid.grsp.lamb0@data$strata
nobservers = grid.grsp.lamb0@data$nobservers

# the geobugs adjacency data is in the collapsed section immediately below  (~560 rows)
### it was generated from the shapefile grid.grsp.lamb0 in the QGIS plugin "maps2WinBUGS"
### note: also tried: poly2nb(grid.grsp.lamb0) in R, but made a "list" instead of a vector, which didn't work
######
adj = c(6,
        6,
        10, 9, 4,
        11, 10, 9, 5, 3,
        11, 10, 4,
        14, 13, 2, 1,
        16,
        22,
        24, 23, 22, 10, 4, 3,
        25, 24, 23, 11, 9, 5, 4, 3,
        26, 25, 24, 10, 5, 4,
        28, 27, 26, 13,
        28, 27, 14, 12, 6,
        29, 28, 13, 6,
        30, 29,
        33, 32, 31, 17, 7,
        34, 33, 32, 18, 16,
        35, 34, 33, 19, 17,
        35, 34, 20, 18,
        35, 21, 19,
        20,
        37, 23, 9, 8,
        38, 37, 24, 22, 10, 9,
        39, 38, 25, 23, 11, 10, 9,
        40, 39, 38, 26, 24, 11, 10,
        41, 40, 39, 27, 25, 12, 11,
        42, 41, 40, 28, 26, 13, 12,
        43, 42, 41, 27, 14, 13, 12,
        45, 44, 43, 15, 14,
        47, 46, 45, 31, 15,
        48, 47, 46, 32, 30, 16,
        49, 48, 47, 33, 31, 17, 16,
        50, 49, 48, 34, 32, 18, 17, 16,
        51, 50, 49, 35, 33, 19, 18, 17,
        52, 51, 50, 34, 20, 19, 18,
        58, 57,
        61, 60, 23, 22,
        62, 61, 39, 25, 24, 23,
        62, 40, 38, 26, 25, 24,
        63, 41, 39, 27, 26, 25,
        64, 63, 42, 40, 28, 27, 26,
        64, 63, 43, 41, 28, 27,
        65, 64, 44, 42, 29, 28,
        65, 45, 43, 29,
        66, 65, 46, 44, 30, 29,
        67, 66, 47, 45, 31, 30,
        68, 67, 66, 48, 46, 32, 31, 30,
        69, 68, 67, 49, 47, 33, 32, 31,
        70, 69, 68, 50, 48, 34, 33, 32,
        71, 70, 69, 51, 49, 35, 34, 33,
        72, 71, 70, 52, 50, 35, 34,
        73, 72, 71, 53, 51, 35,
        74, 73, 72, 54, 52,
        75, 74, 73, 55, 53,
        76, 75, 74, 56, 54,
        76, 75, 55,
        78, 77, 58, 36,
        79, 78, 77, 59, 57, 36,
        80, 79, 78, 58,
        37,
        62, 38, 37,
        61, 39, 38,
        81, 64, 42, 41, 40,
        82, 81, 63, 43, 42, 41,
        83, 82, 45, 44, 43,
        85, 84, 67, 47, 46, 45,
        86, 85, 84, 68, 66, 48, 47, 46,
        87, 86, 85, 69, 67, 49, 48, 47,
        88, 87, 86, 70, 68, 50, 49, 48,
        89, 88, 87, 71, 69, 51, 50, 49,
        90, 89, 88, 72, 70, 52, 51, 50,
        91, 90, 89, 73, 71, 53, 52, 51,
        92, 91, 90, 74, 72, 54, 53, 52,
        93, 92, 91, 75, 73, 55, 54, 53,
        94, 93, 92, 76, 74, 56, 55, 54,
        95, 94, 93, 75, 56, 55,
        104, 103, 102, 78, 58, 57,
        105, 104, 103, 79, 77, 59, 58, 57,
        105, 104, 80, 78, 59, 58,
        105, 79, 59,
        106, 64, 63,
        107, 83, 65, 64,
        108, 107, 82, 65,
        110, 109, 108, 85, 67, 66,
        111, 110, 109, 86, 84, 68, 67, 66,
        112, 111, 110, 87, 85, 69, 68, 67,
        113, 112, 111, 88, 86, 70, 69, 68,
        114, 113, 112, 89, 87, 71, 70, 69,
        115, 114, 113, 90, 88, 72, 71, 70,
        116, 115, 114, 91, 89, 73, 72, 71,
        117, 116, 115, 92, 90, 74, 73, 72,
        118, 117, 116, 93, 91, 75, 74, 73,
        119, 118, 117, 94, 92, 76, 75, 74,
        120, 119, 118, 95, 93, 76, 75,
        121, 120, 119, 96, 94, 76,
        122, 121, 120, 97, 95,
        123, 122, 121, 98, 96,
        124, 123, 122, 97,
        127, 126, 100,
        127, 101, 99,
        128, 127, 100,
        103, 77,
        104, 102, 78, 77,
        105, 103, 79, 78, 77,
        104, 80, 79, 78,
        136, 135, 81,
        139, 138, 137, 108, 83, 82,
        140, 139, 138, 109, 107, 84, 83,
        141, 140, 139, 110, 108, 85, 84,
        142, 141, 140, 111, 109, 86, 85, 84,
        143, 142, 141, 112, 110, 87, 86, 85,
        144, 143, 142, 113, 111, 88, 87, 86,
        145, 144, 143, 114, 112, 89, 88, 87,
        146, 145, 144, 115, 113, 90, 89, 88,
        147, 146, 145, 116, 114, 91, 90, 89,
        148, 147, 146, 117, 115, 92, 91, 90,
        149, 148, 147, 118, 116, 93, 92, 91,
        150, 149, 148, 119, 117, 94, 93, 92,
        151, 150, 149, 120, 118, 95, 94, 93,
        152, 151, 150, 121, 119, 96, 95, 94,
        153, 152, 151, 122, 120, 97, 96, 95,
        154, 153, 152, 123, 121, 98, 97, 96,
        155, 154, 153, 124, 122, 98, 97,
        156, 155, 154, 125, 123, 98,
        156, 155, 126, 124,
        157, 156, 125, 99,
        159, 158, 157, 101, 100, 99,
        160, 159, 129, 101,
        161, 160, 128,
        166, 165, 164, 131,
        167, 166, 165, 132, 130,
        168, 167, 166, 131,
        175, 174, 173, 134,
        175, 174, 133,
        177, 176, 136, 106,
        178, 177, 176, 137, 135, 106,
        178, 177, 138, 136, 107,
        179, 178, 139, 137, 108, 107,
        180, 179, 140, 138, 109, 108, 107,
        181, 180, 179, 141, 139, 110, 109, 108,
        182, 181, 180, 142, 140, 111, 110, 109,
        183, 182, 181, 143, 141, 112, 111, 110,
        184, 183, 182, 144, 142, 113, 112, 111,
        185, 184, 183, 145, 143, 114, 113, 112,
        186, 185, 184, 146, 144, 115, 114, 113,
        187, 186, 185, 147, 145, 116, 115, 114,
        188, 187, 186, 148, 146, 117, 116, 115,
        189, 188, 187, 149, 147, 118, 117, 116,
        190, 189, 188, 150, 148, 119, 118, 117,
        191, 190, 189, 151, 149, 120, 119, 118,
        192, 191, 190, 152, 150, 121, 120, 119,
        193, 192, 191, 153, 151, 122, 121, 120,
        194, 193, 192, 154, 152, 123, 122, 121,
        195, 194, 193, 155, 153, 124, 123, 122,
        195, 194, 156, 154, 125, 124, 123,
        196, 195, 155, 126, 125, 124,
        198, 197, 196, 158, 127, 126,
        199, 198, 197, 159, 157, 127,
        200, 199, 198, 158, 128, 127,
        202, 201, 200, 161, 129, 128,
        203, 202, 201, 162, 160, 129,
        204, 203, 202, 163, 161,
        205, 204, 203, 164, 162,
        206, 205, 204, 165, 163, 130,
        207, 206, 205, 166, 164, 131, 130,
        207, 206, 167, 165, 132, 131, 130,
        208, 207, 168, 166, 132, 131,
        208, 167, 132,
        0,
        0,
        0,
        0,
        211, 210, 174, 133,
        212, 211, 175, 173, 134, 133,
        212, 174, 134, 133,
        214, 213, 177, 136, 135,
        215, 214, 178, 176, 137, 136, 135,
        216, 215, 214, 177, 138, 137, 136,
        218, 217, 216, 180, 140, 139, 138,
        219, 218, 217, 181, 179, 141, 140, 139,
        220, 219, 218, 182, 180, 142, 141, 140,
        221, 220, 219, 183, 181, 143, 142, 141,
        222, 221, 220, 184, 182, 144, 143, 142,
        223, 222, 221, 185, 183, 145, 144, 143,
        224, 223, 222, 186, 184, 146, 145, 144,
        225, 224, 223, 187, 185, 147, 146, 145,
        226, 225, 224, 188, 186, 148, 147, 146,
        227, 226, 225, 189, 187, 149, 148, 147,
        228, 227, 226, 190, 188, 150, 149, 148,
        229, 228, 227, 191, 189, 151, 150, 149,
        230, 229, 228, 192, 190, 152, 151, 150,
        231, 230, 229, 193, 191, 153, 152, 151,
        232, 231, 230, 194, 192, 154, 153, 152,
        233, 232, 231, 195, 193, 155, 154, 153,
        233, 232, 194, 156, 155, 154,
        235, 234, 197, 157, 156,
        236, 235, 234, 198, 196, 158, 157,
        237, 236, 235, 199, 197, 159, 158, 157,
        238, 237, 236, 200, 198, 159, 158,
        239, 238, 237, 201, 199, 160, 159,
        240, 239, 238, 202, 200, 161, 160,
        241, 240, 239, 203, 201, 162, 161, 160,
        242, 241, 240, 204, 202, 163, 162, 161,
        243, 242, 241, 205, 203, 164, 163, 162,
        244, 243, 242, 206, 204, 165, 164, 163,
        245, 244, 243, 207, 205, 166, 165, 164,
        246, 245, 244, 206, 167, 166, 165,
        247, 246, 168, 167,
        210,
        250, 211, 209, 173,
        251, 250, 210, 174, 173,
        251, 175, 174,
        176,
        252, 215, 178, 177, 176,
        253, 252, 216, 214, 178, 177,
        254, 253, 217, 215, 179, 178,
        255, 254, 253, 218, 216, 180, 179,
        256, 255, 254, 219, 217, 181, 180, 179,
        257, 256, 255, 220, 218, 182, 181, 180,
        258, 257, 256, 221, 219, 183, 182, 181,
        259, 258, 257, 222, 220, 184, 183, 182,
        260, 259, 258, 223, 221, 185, 184, 183,
        261, 260, 259, 224, 222, 186, 185, 184,
        262, 261, 260, 225, 223, 187, 186, 185,
        263, 262, 261, 226, 224, 188, 187, 186,
        264, 263, 262, 227, 225, 189, 188, 187,
        265, 264, 263, 228, 226, 190, 189, 188,
        266, 265, 264, 229, 227, 191, 190, 189,
        267, 266, 265, 230, 228, 192, 191, 190,
        268, 267, 266, 231, 229, 193, 192, 191,
        269, 268, 267, 232, 230, 194, 193, 192,
        270, 269, 268, 233, 231, 195, 194, 193,
        271, 270, 269, 232, 195, 194,
        273, 272, 271, 235, 197, 196,
        274, 273, 272, 236, 234, 198, 197, 196,
        275, 274, 273, 237, 235, 199, 198, 197,
        276, 275, 274, 238, 236, 200, 199, 198,
        277, 276, 275, 239, 237, 201, 200, 199,
        278, 277, 276, 240, 238, 202, 201, 200,
        279, 278, 277, 241, 239, 203, 202, 201,
        280, 279, 278, 242, 240, 204, 203, 202,
        281, 280, 279, 243, 241, 205, 204, 203,
        282, 281, 280, 244, 242, 206, 205, 204,
        283, 282, 281, 245, 243, 207, 206, 205,
        284, 283, 282, 246, 244, 207, 206,
        285, 284, 283, 247, 245, 208, 207,
        286, 285, 284, 246, 208,
        286,
        289, 288,
        251, 211, 210,
        291, 250, 212, 211,
        294, 293, 215, 214,
        295, 294, 254, 217, 216, 215,
        296, 295, 255, 253, 218, 217, 216,
        297, 296, 295, 256, 254, 219, 218, 217,
        298, 297, 296, 257, 255, 220, 219, 218,
        299, 298, 297, 258, 256, 221, 220, 219,
        300, 299, 298, 259, 257, 222, 221, 220,
        301, 300, 299, 260, 258, 223, 222, 221,
        302, 301, 300, 261, 259, 224, 223, 222,
        303, 302, 301, 262, 260, 225, 224, 223,
        304, 303, 302, 263, 261, 226, 225, 224,
        305, 304, 303, 264, 262, 227, 226, 225,
        306, 305, 304, 265, 263, 228, 227, 226,
        307, 306, 305, 266, 264, 229, 228, 227,
        308, 307, 306, 267, 265, 230, 229, 228,
        309, 308, 307, 268, 266, 231, 230, 229,
        310, 309, 308, 269, 267, 232, 231, 230,
        311, 310, 309, 270, 268, 233, 232, 231,
        312, 311, 310, 271, 269, 233, 232,
        313, 312, 311, 272, 270, 234, 233,
        314, 313, 312, 273, 271, 235, 234,
        315, 314, 313, 274, 272, 236, 235, 234,
        316, 315, 314, 275, 273, 237, 236, 235,
        317, 316, 315, 276, 274, 238, 237, 236,
        318, 317, 316, 277, 275, 239, 238, 237,
        319, 318, 317, 278, 276, 240, 239, 238,
        320, 319, 318, 279, 277, 241, 240, 239,
        321, 320, 319, 280, 278, 242, 241, 240,
        322, 321, 320, 281, 279, 243, 242, 241,
        323, 322, 321, 282, 280, 244, 243, 242,
        324, 323, 322, 283, 281, 245, 244, 243,
        325, 324, 323, 284, 282, 246, 245, 244,
        325, 324, 285, 283, 247, 246, 245,
        326, 325, 286, 284, 247, 246,
        326, 285, 248, 247,
        327, 288,
        327, 289, 287, 249,
        327, 288, 249,
        0,
        251,
        0,
        294, 252,
        293, 253, 252,
        329, 328, 296, 255, 254, 253,
        330, 329, 328, 297, 295, 256, 255, 254,
        331, 330, 329, 298, 296, 257, 256, 255,
        332, 331, 330, 299, 297, 258, 257, 256,
        333, 332, 331, 300, 298, 259, 258, 257,
        334, 333, 332, 301, 299, 260, 259, 258,
        335, 334, 333, 302, 300, 261, 260, 259,
        336, 335, 334, 303, 301, 262, 261, 260,
        337, 336, 335, 304, 302, 263, 262, 261,
        338, 337, 336, 305, 303, 264, 263, 262,
        339, 338, 337, 306, 304, 265, 264, 263,
        340, 339, 338, 307, 305, 266, 265, 264,
        341, 340, 339, 308, 306, 267, 266, 265,
        342, 341, 340, 309, 307, 268, 267, 266,
        343, 342, 341, 310, 308, 269, 268, 267,
        344, 343, 342, 311, 309, 270, 269, 268,
        345, 344, 343, 312, 310, 271, 270, 269,
        346, 345, 344, 313, 311, 272, 271, 270,
        347, 346, 345, 314, 312, 273, 272, 271,
        348, 347, 346, 315, 313, 274, 273, 272,
        349, 348, 347, 316, 314, 275, 274, 273,
        350, 349, 348, 317, 315, 276, 275, 274,
        351, 350, 349, 318, 316, 277, 276, 275,
        352, 351, 350, 319, 317, 278, 277, 276,
        353, 352, 351, 320, 318, 279, 278, 277,
        354, 353, 352, 321, 319, 280, 279, 278,
        355, 354, 353, 322, 320, 281, 280, 279,
        356, 355, 354, 323, 321, 282, 281, 280,
        357, 356, 355, 324, 322, 283, 282, 281,
        358, 357, 356, 325, 323, 284, 283, 282,
        358, 357, 324, 285, 284, 283,
        286, 285,
        360, 359, 289, 288, 287,
        364, 363, 329, 296, 295,
        365, 364, 363, 330, 328, 297, 296, 295,
        366, 365, 364, 331, 329, 298, 297, 296,
        367, 366, 365, 332, 330, 299, 298, 297,
        368, 367, 366, 333, 331, 300, 299, 298,
        369, 368, 367, 334, 332, 301, 300, 299,
        370, 369, 368, 335, 333, 302, 301, 300,
        371, 370, 369, 336, 334, 303, 302, 301,
        372, 371, 370, 337, 335, 304, 303, 302,
        373, 372, 371, 338, 336, 305, 304, 303,
        374, 373, 372, 339, 337, 306, 305, 304,
        375, 374, 373, 340, 338, 307, 306, 305,
        376, 375, 374, 341, 339, 308, 307, 306,
        377, 376, 375, 342, 340, 309, 308, 307,
        378, 377, 376, 343, 341, 310, 309, 308,
        379, 378, 377, 344, 342, 311, 310, 309,
        380, 379, 378, 345, 343, 312, 311, 310,
        381, 380, 379, 346, 344, 313, 312, 311,
        382, 381, 380, 347, 345, 314, 313, 312,
        383, 382, 381, 348, 346, 315, 314, 313,
        384, 383, 382, 349, 347, 316, 315, 314,
        385, 384, 383, 350, 348, 317, 316, 315,
        386, 385, 384, 351, 349, 318, 317, 316,
        387, 386, 385, 352, 350, 319, 318, 317,
        388, 387, 386, 353, 351, 320, 319, 318,
        389, 388, 387, 354, 352, 321, 320, 319,
        390, 389, 388, 355, 353, 322, 321, 320,
        391, 390, 389, 356, 354, 323, 322, 321,
        392, 391, 390, 357, 355, 324, 323, 322,
        392, 391, 358, 356, 325, 324, 323,
        392, 357, 325, 324,
        393, 360, 327,
        393, 361, 359, 327,
        394, 393, 362, 360,
        394, 361,
        397, 396, 364, 329, 328,
        398, 397, 365, 363, 330, 329, 328,
        399, 398, 397, 366, 364, 331, 330, 329,
        400, 399, 398, 367, 365, 332, 331, 330,
        401, 400, 399, 368, 366, 333, 332, 331,
        402, 401, 400, 369, 367, 334, 333, 332,
        403, 402, 401, 370, 368, 335, 334, 333,
        404, 403, 402, 371, 369, 336, 335, 334,
        405, 404, 403, 372, 370, 337, 336, 335,
        406, 405, 404, 373, 371, 338, 337, 336,
        407, 406, 405, 374, 372, 339, 338, 337,
        408, 407, 406, 375, 373, 340, 339, 338,
        409, 408, 407, 376, 374, 341, 340, 339,
        410, 409, 408, 377, 375, 342, 341, 340,
        411, 410, 409, 378, 376, 343, 342, 341,
        412, 411, 410, 379, 377, 344, 343, 342,
        413, 412, 411, 380, 378, 345, 344, 343,
        414, 413, 412, 381, 379, 346, 345, 344,
        415, 414, 413, 382, 380, 347, 346, 345,
        416, 415, 414, 383, 381, 348, 347, 346,
        417, 416, 415, 384, 382, 349, 348, 347,
        418, 417, 416, 385, 383, 350, 349, 348,
        418, 417, 386, 384, 351, 350, 349,
        419, 418, 387, 385, 352, 351, 350,
        420, 419, 388, 386, 353, 352, 351,
        421, 420, 419, 389, 387, 354, 353, 352,
        422, 421, 420, 390, 388, 355, 354, 353,
        423, 422, 421, 391, 389, 356, 355, 354,
        423, 422, 392, 390, 357, 356, 355,
        423, 391, 358, 357, 356,
        424, 361, 360, 359,
        424, 362, 361,
        0,
        425, 363,
        427, 426, 425, 398, 365, 364, 363,
        428, 427, 426, 399, 397, 366, 365, 364,
        429, 428, 427, 400, 398, 367, 366, 365,
        430, 429, 428, 401, 399, 368, 367, 366,
        431, 430, 429, 402, 400, 369, 368, 367,
        432, 431, 430, 403, 401, 370, 369, 368,
        433, 432, 431, 404, 402, 371, 370, 369,
        434, 433, 432, 405, 403, 372, 371, 370,
        435, 434, 433, 406, 404, 373, 372, 371,
        436, 435, 434, 407, 405, 374, 373, 372,
        437, 436, 435, 408, 406, 375, 374, 373,
        438, 437, 436, 409, 407, 376, 375, 374,
        439, 438, 437, 410, 408, 377, 376, 375,
        440, 439, 438, 411, 409, 378, 377, 376,
        441, 440, 439, 412, 410, 379, 378, 377,
        442, 441, 440, 413, 411, 380, 379, 378,
        443, 442, 441, 414, 412, 381, 380, 379,
        444, 443, 442, 415, 413, 382, 381, 380,
        445, 444, 443, 416, 414, 383, 382, 381,
        446, 445, 444, 417, 415, 384, 383, 382,
        447, 446, 445, 418, 416, 385, 384, 383,
        448, 447, 446, 417, 386, 385, 384,
        450, 449, 448, 420, 388, 387, 386,
        451, 450, 449, 421, 419, 389, 388, 387,
        452, 451, 450, 422, 420, 390, 389, 388,
        452, 451, 423, 421, 391, 390, 389,
        452, 422, 392, 391, 390,
        453, 394, 393,
        455, 454, 426, 397, 396,
        456, 455, 454, 427, 425, 398, 397,
        457, 456, 455, 428, 426, 399, 398, 397,
        458, 457, 456, 429, 427, 400, 399, 398,
        459, 458, 457, 430, 428, 401, 400, 399,
        460, 459, 458, 431, 429, 402, 401, 400,
        461, 460, 459, 432, 430, 403, 402, 401,
        462, 461, 460, 433, 431, 404, 403, 402,
        463, 462, 461, 434, 432, 405, 404, 403,
        464, 463, 462, 435, 433, 406, 405, 404,
        464, 463, 436, 434, 407, 406, 405,
        464, 437, 435, 408, 407, 406,
        465, 438, 436, 409, 408, 407,
        466, 465, 439, 437, 410, 409, 408,
        467, 466, 465, 440, 438, 411, 410, 409,
        468, 467, 466, 441, 439, 412, 411, 410,
        469, 468, 467, 442, 440, 413, 412, 411,
        470, 469, 468, 443, 441, 414, 413, 412,
        471, 470, 469, 444, 442, 415, 414, 413,
        472, 471, 470, 445, 443, 416, 415, 414,
        472, 471, 446, 444, 417, 416, 415,
        473, 472, 447, 445, 418, 417, 416,
        474, 473, 448, 446, 418, 417,
        475, 474, 473, 449, 447, 419, 418,
        476, 475, 474, 450, 448, 420, 419,
        477, 476, 475, 451, 449, 421, 420, 419,
        478, 477, 476, 452, 450, 422, 421, 420,
        478, 477, 451, 423, 422, 421,
        480, 479, 424,
        482, 481, 455, 426, 425,
        483, 482, 481, 456, 454, 427, 426, 425,
        484, 483, 482, 457, 455, 428, 427, 426,
        485, 484, 483, 458, 456, 429, 428, 427,
        486, 485, 484, 459, 457, 430, 429, 428,
        487, 486, 485, 460, 458, 431, 430, 429,
        488, 487, 486, 461, 459, 432, 431, 430,
        489, 488, 487, 462, 460, 433, 432, 431,
        490, 489, 488, 463, 461, 434, 433, 432,
        490, 489, 464, 462, 435, 434, 433,
        491, 490, 463, 436, 435, 434,
        492, 466, 439, 438, 437,
        492, 467, 465, 440, 439, 438,
        493, 492, 468, 466, 441, 440, 439,
        494, 493, 469, 467, 442, 441, 440,
        495, 494, 493, 470, 468, 443, 442, 441,
        496, 495, 494, 471, 469, 444, 443, 442,
        497, 496, 495, 472, 470, 445, 444, 443,
        498, 497, 496, 471, 446, 445, 444,
        500, 499, 498, 474, 448, 447, 446,
        501, 500, 499, 475, 473, 449, 448, 447,
        502, 501, 500, 476, 474, 450, 449, 448,
        502, 501, 477, 475, 451, 450, 449,
        502, 478, 476, 452, 451, 450,
        477, 452, 451,
        480, 453,
        479, 453,
        505, 504, 482, 455, 454,
        506, 505, 504, 483, 481, 456, 455, 454,
        507, 506, 505, 484, 482, 457, 456, 455,
        508, 507, 506, 485, 483, 458, 457, 456,
        509, 508, 507, 486, 484, 459, 458, 457,
        510, 509, 508, 487, 485, 460, 459, 458,
        511, 510, 509, 488, 486, 461, 460, 459,
        512, 511, 510, 489, 487, 462, 461, 460,
        513, 512, 511, 490, 488, 463, 462, 461,
        513, 512, 489, 464, 463, 462,
        514, 464,
        467, 466, 465,
        515, 494, 469, 468, 467,
        516, 515, 495, 493, 470, 469, 468,
        517, 516, 496, 494, 471, 470, 469,
        518, 517, 516, 497, 495, 472, 471, 470,
        519, 518, 517, 498, 496, 472, 471,
        520, 519, 518, 499, 497, 473, 472,
        521, 520, 519, 500, 498, 474, 473,
        521, 520, 501, 499, 475, 474, 473,
        521, 502, 500, 476, 475, 474,
        501, 477, 476, 475,
        0,
        505, 482, 481,
        506, 504, 483, 482, 481,
        522, 507, 505, 484, 483, 482,
        523, 522, 508, 506, 485, 484, 483,
        524, 523, 522, 509, 507, 486, 485, 484,
        525, 524, 523, 510, 508, 487, 486, 485,
        526, 525, 524, 511, 509, 488, 487, 486,
        527, 526, 525, 512, 510, 489, 488, 487,
        527, 526, 513, 511, 490, 489, 488,
        527, 512, 490, 489,
        491,
        494, 493,
        529, 528, 517, 496, 495, 494,
        530, 529, 528, 518, 516, 497, 496, 495,
        531, 530, 529, 519, 517, 498, 497, 496,
        531, 530, 520, 518, 499, 498, 497,
        531, 521, 519, 500, 499, 498,
        520, 501, 500, 499,
        534, 533, 523, 508, 507, 506,
        535, 534, 533, 524, 522, 509, 508, 507,
        536, 535, 534, 525, 523, 510, 509, 508,
        537, 536, 535, 526, 524, 511, 510, 509,
        538, 537, 536, 527, 525, 512, 511, 510,
        539, 538, 537, 526, 513, 512, 511,
        540, 529, 517, 516,
        540, 530, 528, 518, 517, 516,
        531, 529, 519, 518, 517,
        530, 520, 519, 518,
        0,
        542, 534, 523, 522,
        543, 542, 535, 533, 524, 523, 522,
        544, 543, 536, 534, 525, 524, 523,
        545, 544, 543, 537, 535, 526, 525, 524,
        546, 545, 544, 538, 536, 527, 526, 525,
        547, 546, 545, 539, 537, 527, 526,
        547, 546, 538, 527,
        529, 528,
        0,
        534, 533,
        549, 548, 544, 536, 535, 534,
        550, 549, 548, 545, 543, 537, 536, 535,
        551, 550, 549, 546, 544, 538, 537, 536,
        551, 550, 547, 545, 539, 538, 537,
        551, 546, 539, 538,
        553, 552, 549, 544, 543,
        554, 553, 552, 550, 548, 545, 544, 543,
        554, 553, 551, 549, 546, 545, 544,
        554, 550, 547, 546, 545,
        556, 555, 553, 549, 548,
        556, 555, 554, 552, 550, 549, 548,
        556, 553, 551, 550, 549,
        557, 556, 553, 552,
        558, 557, 555, 554, 553, 552,
        558, 556, 555,
        557, 556)
######

## next lines are also output from the maps2WinBUGS plugin in QGIS
num = c(1, 1, 3, 5, 3, 4, 1, 1, 6, 8, 6, 4, 5, 4, 2, 5, 5, 5, 4, 3, 1, 4, 6, 7, 7, 7, 7, 7, 5, 5, 6, 7, 8, 8, 7, 2, 4, 6, 6, 6, 7, 6, 6, 4, 6, 6, 8, 8, 8, 8, 7, 6, 5, 5, 5, 3, 4, 6, 4, 1, 3, 3, 5, 6, 5, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 6, 8, 6, 3, 3, 4, 4, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 5, 4, 3, 3, 3, 2, 4, 5, 4, 3, 6, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 4, 4, 6, 4, 3, 4, 5, 4, 4, 3, 4, 6, 5, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 6, 6, 6, 6, 6, 5, 5, 6, 7, 7, 6, 3, 1, 1, 1, 1, 4, 6, 4, 5, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 5, 7, 8, 7, 7, 7, 8, 8, 8, 8, 8, 7, 4, 1, 4, 5, 3, 1, 5, 6, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 5, 1, 2, 3, 4, 4, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 4, 2, 4, 3, 1, 1, 1, 2, 3, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 6, 2, 5, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 4, 3, 4, 4, 2, 5, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 7, 8, 8, 8, 7, 5, 4, 3, 1, 2, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 8, 8, 7, 5, 3, 5, 7, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 6, 7, 8, 8, 8, 8, 8, 8, 7, 7, 6, 7, 7, 8, 8, 6, 3, 5, 8, 8, 8, 8, 8, 8, 8, 8, 7, 6, 5, 6, 7, 7, 8, 8, 8, 7, 7, 8, 8, 7, 6, 3, 2, 2, 5, 8, 8, 8, 8, 8, 8, 8, 8, 6, 2, 3, 5, 7, 7, 8, 7, 7, 7, 7, 6, 4, 1, 3, 5, 6, 7, 8, 8, 8, 8, 7, 4, 1, 2, 6, 8, 8, 7, 6, 4, 6, 8, 8, 8, 8, 7, 4, 6, 5, 4, 1, 4, 7, 7, 8, 8, 7, 4, 2, 1, 2, 6, 8, 8, 7, 4, 5, 8, 7, 5, 5, 7, 5, 4, 6, 3, 2)
sumNumNeigh = sum(num)

# if R2WinBUGS doesn't work, this code will make a separate text file of the data to use in winbugs directly 
bugs.data(list("count"=count, "strat"=strat, "obser"=obser, "firstyr"=firstyr,
               "year"=year,"ncounts"=ncounts,"nstrata"=nstrata,"ymin"=ymin,
               "ymax"=ymax,"nonzeroweight"=nonzeroweight,"adj"=adj,"num"=num,
               "sumNumNeigh"=sumNumNeigh, "nobservers"=nobservers, "strata"=strata), 
               "data/geobugs",12,data.file="data.txt")


# adapted from Gelman's code in JSS paper, updated for this analysis

data <- list("count"=count, "strat"=strat, "obser"=obser, 
             "firstyr"=firstyr, "year"=year, "ncounts"=ncounts, 
             "nstrata"=nstrata, "ymin"=ymin, "ymax"=ymax,
             "nonzeroweight"=nonzeroweight, "sumNumNeigh"=sumNumNeigh, 
             "adj"=adj, "num"=num, "nobservers"=nobservers, "strata"=strata)

parameters <- c("n")

# not sure what inits to put, but got clues from Scottish lip cancer example bugs code: lipsbrad.odc
# example was here: https://conservancy.umn.edu/handle/11299/200500
inits1 <- list(eta = 1, taunoise = 1, mulogtauobs = 1, taulogtauobs = 1, n = 1)
inits2 <- list(eta = 0.5, taunoise = 0.5, mulogtauobs = 0.5, taulogtauobs = 0.5, n = 0.5)
inits <- list(inits1, inits2)

model <- bugs(data = data, inits=NULL, parameters.to.save="n", 
        model.file = "C:/Users/Mike/Documents/Research/Chapter 3 - Synchrony/GLBsynchrony/data/geobugs/grsp_carcode.bug",
        n.chains = 2, n.iter = 8000, n.burnin = 5000, n.thin = 1,
        codaPkg = TRUE, bugs.directory = "C:/Program Files (x86)/OpenBUGS323",
        program="OpenBUGS", debug = TRUE)

library("coda")
codaobject <- read.bugs(model)
plot(codaobject)